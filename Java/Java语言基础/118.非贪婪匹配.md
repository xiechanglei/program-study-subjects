> 内容来源于：[https://liaoxuefeng.com/books/java/reg-exp/non-greedy/index.html](https://liaoxuefeng.com/books/java/reg-exp/non-greedy/index.html)

在正则表达式中，另一个重要的概念是非贪婪匹配和贪婪匹配。

在构造`Pattern`对象时，我们可以设置贪婪模式和非贪婪模式。我们来看一个例子：

假设我们要匹配一个HTML标签内的内容，例如，`<html><h1>标题</h1></html>`，是否可以用正则`<\\w+>(.*)<\\/\\w+>`来匹配？我们来试试看：

```java
import java.util.regex.*;

public class Main {
    public static void main(String[] args) {
        Pattern p = Pattern.compile("<\\w+>(.*)</\\w+>");
        Matcher m = p.matcher("<html><h1>标题</h1></html>");
        if (m.matches()) {
            System.out.println(m.group(1)); // <h1>标题</h1></html>
        }
    }
}
```

程序并没有返回我们期望的"标题"，而是返回了`<h1>标题</h1></html>`，观察正则`<\\w+>(.*)</\\w+>`，它会匹配`<html>`，然后，由于`.*`试图匹配尽可能多的字符，因此，连`</html>`都被匹配了，所以group(1)返回的不是"标题"，而是`<h1>标题</h1></html>`。

像上面这种匹配方式，叫做贪婪匹配，即匹配尽可能多的字符。类似的，`+`和`?`也有贪婪匹配问题。

正则表达式默认使用贪婪匹配模式，但如果我们想让`.*`、`.+`等尽可能少地匹配，就需要加一个`?`，让`.*`变成`.*?`，让`.+`变成`.+?`，让`?`变成`??`，变成非贪婪匹配：

```java
import java.util.regex.*;

public class Main {
    public static void main(String[] args) {
        Pattern p = Pattern.compile("<\\w+>(.*?)</\\w+>");
        Matcher m = p.matcher("<html><h1>标题</h1></html>");
        if (m.matches()) {
            System.out.println(m.group(1)); // <h1>标题</h1>
        }
    }
}
```

我们看到，加了一个`?`后，`.*?`就会匹配尽可能少的字符（但必须至少出现一次），因此，匹配`<html><h1>标题</h1></html>`时，它会匹配`<html>`，然后匹配最少的`<h1>标题</h1>`，然后匹配`</html>`。

## 练习

给定一段文本：

```java
String text = "正则表达式(regular expression)是一种强大的(text manipulation)工具，可以用来(match)和(search)各种(文本处理)。";
```

请用非贪婪匹配提取所有括号内的内容。

## 小结

正则表达式匹配默认使用贪婪匹配，若要使用非贪婪匹配，则需在指定匹配次数的元字符后加?。